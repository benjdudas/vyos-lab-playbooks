---

- hosts: vyos-net1
  gather_facts: false
  connection: network_cli

  tasks:

    - name: setting system motd
      vyos_banner:
        banner: pre-login
        text: ANSIBLE CONFIGURED BANNER - authorized access only!!
        state: present

    - name: configuring ospf
      vyos_config:
        lines:
          - set interfaces loopback lo address {{ lo }}
          - set protocols ospf area 0 network {{ net1 }}
          - set protocols ospf area 0 network {{ net2 }}
          - set protocols ospf area 0 network {{ net3 }}
          - set protocols ospf default-information originate always
          - set protocols ospf default-information originate metric 10
          - set protocols ospf default-information originate metric-type 2
          - set protocols ospf log-adjacency-changes
          - set protocols ospf parameters router-id 1.1.1.1
          - set protocols ospf redistribute connected metric-type 2
          - set protocols ospf redistribute connected route-map CONNECT
          - set policy route-map CONNECT rule 10 action permit
          - set policy route-map CONNECT rule 10 match interface lo
        save: yes

...
